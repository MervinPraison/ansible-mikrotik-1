---

- name: collect MikroTik facts
  hosts: mikrotik_routers
  connection: local

  vars_files:
    - routeros/versions.yml

  tasks:

  - debug:
      var: routeros_current
    run_once: true

  - name: upgrade and reboot
    mikrotik_package:
      hostname: "{{ inventory_hostname }}"
      username: admin
      version: "{{ routeros_current }}"
      packages:
        - system
        - security
        - dhcp
        - advanced-tools
      reboot: true
